# 分层设计

## 后端代码目录

```sh
└── server
    ├── controllers # 操作层 执行服务端模板渲染，json接口返回数据，页面跳转
    │   ├── admin.js
    │   ├── index.js
    │   ├── user-info.js
    │   └── work.js
    ├── models # 数据模型层 执行数据操作
    │   └── user-Info.js
    ├── routers # 路由层 控制路由
    │   ├── admin.js
    │   ├── api.js
    │   ├── error.js
    │   ├── home.js
    │   ├── index.js
    │   └── work.js
    ├── services # 业务层 实现数据层model到操作层controller的耦合封装
    │   └── user-info.js
    └── views # 服务端模板代码
        ├── admin.ejs
        ├── error.ejs
        ├── index.ejs
        └── work.ejs
```
#项目工程化设计原则
##单业务模块化

大多数的内务需求，都最终可以被归纳进单个模块，模块与模块间具有物理文件独立性，能更好地便于多人的项目团队人员同时维护代码。

##模块二百行原则

二百行是个虚数泛指，但也在大量的项目实践后发现，大多数单文件的模块代码，在良好的设计规划下，往往很难突破两百行的数目，而两百行内的代码的阅读与维护，也都是一个心理压力较小的量级。

正所谓合久必分，单个模块的代码量大量增长，可以考虑分离部分代码到外部文件来管理，通过模块 require 的方式形成关联，以保持各模块代码的相对精简与可维护性。

##同类模块分组化

分组在本文中一般指形成一个文件目录，来对一些功能相似的业务模块形成管理，比如常见的路由模块，会有大量不同的基于 resource 的资源路由，被分离在单个模块文件中，最终汇总在 router 的目录。再比如定义数据库表结构映射关系的 model 模型类模块，最终也往往会习惯汇总到一个 model 的目录中，形成统一管理。

##配置文件分离

系统中往往会存在一些诸如服务启动的端口号、服务名称、数据库连接配置、服务启动的性能参数域值配置等等，这些参数的业务逻辑往往离散在系统中的各个独立模块中，将其抽取在一个统一的类似 config.js 的配置文件中进行整体管理，可以避免日后打地鼠式的在模块中四处找寻，以及修改编辑疏漏。